---
import { Image } from "astro:assets";
import { Icon } from "astro-icon/components";
---

<header
    id="header"
    class="container-grid bg-bg transition-color border-b-ui/0 @container sticky top-0 z-50 h-16 border-b font-medium duration-200 ease-in-out"
>
    <section class="container-side"></section>

    <section class="container-main relative">
        <div class="flex h-full items-center justify-between">
            <!-- LOGO -->
            <a href="/">
                <Image
                    src="/images/logo-light-transparent.png"
                    alt="Logo"
                    width="40"
                    height="40"
                    loading="eager"
                    quality="max"
                />
            </a>

            <!-- DESKTOP MENU -->
            <nav
                class="hidden @md:flex @md:items-center @md:gap-x-8 @md:font-medium"
            >
                <a href="/writings">Writings</a>
                <a href="/projects">Projects</a>
                <a href="/now">Now</a>
                <a href="/about">About</a>
            </nav>

            <!-- MOBILE MENU BUTTON -->
            <button
                id="menu-toggle"
                aria-label="Toggle menu"
                class="relative block h-10 w-10 p-2 @md:hidden"
            >
                <!-- Menu Icon -->
                <Icon
                    id="menu-icon"
                    name="material-symbols:menu-rounded"
                    size="28"
                    class="text-tx absolute inset-0 m-auto scale-100 transition-transform duration-200 ease-in-out"
                />
                <!-- Close Icon -->
                <Icon
                    id="close-icon"
                    name="material-symbols:close-rounded"
                    size="28"
                    class="text-tx absolute inset-0 m-auto scale-0 transition-transform duration-200 ease-in-out"
                />
            </button>
        </div>

        <!-- MOBILE MENU -->
        <div
            id="mobile-menu"
            class="bg-bg pointer-events-none absolute top-16 left-0 w-[calc(100%+2rem)] origin-top -translate-x-4 scale-y-0 opacity-0 transition-all duration-200 ease-in-out @md:hidden"
        >
            <nav class="border-ui/10 flex flex-col border-t">
                <a
                    class="border-b-ui focus:bg-ui/50 flex items-center gap-x-6 border-b px-6 py-4"
                    href="/writings"
                >
                    <Icon
                        name="material-symbols:book-2"
                        size="20"
                        class="text-tx-2"
                    />
                    <span>Writings</span>
                </a>
                <a
                    class="border-b-ui focus:bg-ui/50 flex items-center gap-x-6 border-b px-6 py-4"
                    href="/projects"
                >
                    <Icon
                        name="material-symbols:terminal"
                        size="20"
                        class="text-tx-2"
                    />
                    <span>Projects</span>
                </a>
                <a
                    class="border-b-ui focus:bg-ui/50 flex items-center gap-x-6 border-b px-6 py-4"
                    href="/now"
                >
                    <Icon
                        name="material-symbols:calendar-clock"
                        size="20"
                        class="text-tx-2"
                    />
                    <span>Now</span>
                </a>
                <a
                    class="border-b-ui focus:bg-ui/50 flex items-center gap-x-6 border-b px-6 py-4"
                    href="/about"
                >
                    <Icon
                        name="material-symbols:person"
                        size="20"
                        class="text-tx-2"
                    />
                    <span>About</span>
                </a>
            </nav>
        </div>
    </section>

    <section class="container-side"></section>
</header>

<script is:inline>
    document.addEventListener("astro:page-load", () => {
        const header = document.getElementById("header");
        const toggleBtn = document.getElementById("menu-toggle");
        const menu = document.getElementById("mobile-menu");
        const menuIcon = document.getElementById("menu-icon");
        const closeIcon = document.getElementById("close-icon");

        // Add border after scroll
        window.addEventListener("scroll", () => {
            header.classList.toggle("border-b-ui/100", window.scrollY > 80);
        });

        toggleBtn.addEventListener("click", () => {
            const isOpen = menu.classList.contains("scale-y-100");

            if (isOpen) {
                // Hide menu
                menu.classList.remove("scale-y-100", "opacity-100");
                menu.classList.add(
                    "scale-y-0",
                    "opacity-0",
                    "pointer-events-none"
                );

                // Pop icons
                menuIcon.classList.remove("scale-0");
                menuIcon.classList.add("scale-100");

                closeIcon.classList.remove("scale-100");
                closeIcon.classList.add("scale-0");
            } else {
                // Show menu
                menu.classList.add("scale-y-100", "opacity-100");
                menu.classList.remove(
                    "scale-y-0",
                    "opacity-0",
                    "pointer-events-none"
                );

                // Pop icons
                menuIcon.classList.remove("scale-100");
                menuIcon.classList.add("scale-0");

                closeIcon.classList.remove("scale-0");
                closeIcon.classList.add("scale-100");
            }
        });

        // Close menu when clicking a link
        menu.querySelectorAll("a").forEach((link) =>
            link.addEventListener("click", () => {
                menu.classList.remove("scale-y-100", "opacity-100");
                menu.classList.add(
                    "scale-y-0",
                    "opacity-0",
                    "pointer-events-none"
                );

                menuIcon.classList.remove("scale-0");
                menuIcon.classList.add("scale-100");

                closeIcon.classList.remove("scale-100");
                closeIcon.classList.add("scale-0");
            })
        );
    });
</script>
